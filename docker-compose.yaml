version: '3.8'

services:
  api-gateway:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - PORT=8080
      - GIN_MODE=release
      - BOOKSTORE_SERVICE_URL=http://bookstore-service:5000
      - ORDER_SERVICE_URL=http://order-service:8001
      - JWT_SECRET=your-secret-key-here
      - TOKEN_EXPIRY=24h
      - ALLOWED_ORIGINS=*
    depends_on:
      - bookstore-service
      - order-service
    networks:
      - bookstore-network

  bookstore-service:
    # Your Flask bookstore service configuration
    image: bookstore-service:latest
    ports:
      - "5000:5000"
    networks:
      - bookstore-network

  order-service:
    # Your FastAPI order service configuration
    image: order-service:latest
    ports:
      - "8001:8001"
    networks:
      - bookstore-network

networks:
  bookstore-network:
    driver: bridge